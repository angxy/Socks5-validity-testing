# 代理检测工具使用说明

利用 Grok 编写的s5代理有效性检测工具。

## 功能简介

代理检测工具是一款用于检测代理服务器可用性的 Go 程序，支持多种代理协议（SOCKS5、SOCKS4、HTTP、HTTPS），并提供详细的检测报告和 Telegram 通知功能。程序会从指定目录读取代理列表，测试其连接性，生成结果文件，并通过 Telegram 推送报告和文件。

### 主要功能
1. **代理检测**：
   - 支持的协议：`socks5_auth`（带认证的 SOCKS5）、`socks5_noauth`（无认证的 SOCKS5）、`socks4_auth`（带认证的 SOCKS4）、`socks4_noauth`（无认证的 SOCKS4）、`http` 和 `https`。
   - 测试代理连接性，通过访问 `http://api.ipify.org` 获取代理 IP 和延迟。
   - 并发检测，最大并发数可配置（默认 100）。
   - 使用 GeoIP 数据库（GeoLite2-Country.mmdb）识别代理所在国家。
2. **结果输出**：
   - 生成按协议分类的文本文件（如 `socks5_auth.txt`、`socks5_noauth_tg.txt` 等），存储在配置的输出目录（默认 `OUTPUT`）。
   - SOCKS5 代理额外生成 Telegram 专用格式文件（`t.me/socks?...` 链接）。
   - 输出内容包括代理 URL、延迟、国家代码和名称。
3. **检测报告**：
   - 统计有效代理数量、协议分布、国家分布、延迟统计（均值、最低、最高）。
   - 记录失败原因（如超时、连接被拒等），并规范化显示。
   - 报告同时输出到终端和 Telegram（若配置）。
4. **Telegram 通知**：
   - 通过 Telegram Bot 发送启动通知、检测报告和结果文件。
   - 支持预设代理连接 Telegram API，自动重试（最多 3 次）。
5. **GeoIP 数据库更新**：
   - 支持从指定 URL 下载最新的 GeoLite2-Country.mmdb 数据库。
6. **交互式菜单**：
   - 提供简单终端菜单，支持开始检测、更新 GeoIP 数据库或退出。

## 配置说明

程序依赖 `config.ini` 文件进行配置，文件需位于程序目录下。以下是配置文件结构和说明：

```ini
[telegram]
# Telegram Bot 的 API 令牌，用于发送消息
bot_token = 3065667503:AAERtji4NMIDdAumVP--FBcK_I61EWhOCC0（示例）
# 接收消息的 Telegram 聊天 ID，可以是个人ID或群组ID
chat_id = 390641128（示例）

[settings]
# 连接 Telegram Bot API 的预设代理，支持多个代理（逗号分隔）
preset_proxy = socks5://123456:123456@47.243.141.203:1080,socks5://123456:123456@47.238.128.199:1080
# 读取代理文件的目录
fdip_dir = FDIP
# 输出文件的目录，自动创建
output_dir = OUTPUT
# 代理连接超时时间（秒）
check_timeout = 10
# 并发检测的代理数量
max_concurrent = 100

##################################################################################################

🚀 代理检测工具启动
🎉 代理检测报告
⏰ 耗时: 71.39 秒
✅ 有效代理: 1094 个

🌐 协议分布:
  - socks5_auth_tg: 1094 个

🌍 国家分布:
  - 🇩🇪 德国: 3 个
  - 🇬🇧 英国: 1 个
  - 🇭🇰 香港: 359 个
  - 🇮🇩 印度尼西亚: 1 个
  - 🇯🇵 日本: 114 个
  - 🇰🇷 韩国: 80 个
  - 🇳🇱 荷兰: 1 个
  - 🇵🇭 菲律宾: 2 个
  - 🇸🇬 新加坡: 7 个
  - 🇹🇭 泰国: 2 个
  - 🌐 未知: 1 个
  - 🇺🇸 美国: 520 个
  - 🇻🇳 越南: 3 个

📈 延迟统计:
  - 均值: 1639.82ms
  - 最低: 474.99ms
  - 最高: 9805.13ms

⚠️ 检测失败原因:
  - 连接中断: 555 个
  - 连接失败 (TCP): 454 个
  - 其他错误: 342 个
  - I/O超时: 292 个
  - 操作超时: 14 个
  - 客户端错误 (403): 5 个

📑  socks5_auth.txt
📑  socks5_auth_tg.txt

🎉 脚本运行结束
